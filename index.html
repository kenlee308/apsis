<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APSIS INC. - Solar System Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
        {
          "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
          }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0b0d17;
            --accent-color: #6366f1;
            --sun-color: #f59e0b;
            --sun-glow: #d97706;
            --orbit-color: rgba(255, 255, 255, 0.05);
            --glass-bg: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.1);
            --tilt: 45deg;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg-color);
            color: #ffffff;
            overflow: hidden;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .glow {
            text-shadow: 0 0 15px rgba(99, 102, 241, 0.6), 0 0 30px rgba(99, 102, 241, 0.4);
        }

        /* Nav & Logo Styling */
        nav a {
            position: relative;
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent-color);
            transition: width 0.3s ease;
        }

        nav a:hover::after {
            width: 100%;
        }

        /* Background Effects */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #161b33 0%, #0b0d17 100%);
            z-index: -2;
        }

        .stardust {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("https://www.transparenttextures.com/patterns/stardust.png");
            opacity: 0.15;
            z-index: -1;
        }

        .orbit-control-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            padding: 0.75rem 1.25rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .orbit-control-btn:hover {
            background: rgba(30, 41, 59, 0.6);
            border-color: rgba(99, 102, 241, 0.5);
            transform: translateY(-2px);
        }

        .orbit-control-btn svg {
            width: 1.25rem;
            height: 1.25rem;
        }

        /* Project Planet Highlight */
        .planet-label.highlight {
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            padding: 4px 12px;
            border-radius: 9999px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.5);
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .planet-label.highlight::after {
            content: 'NEW';
            font-size: 8px;
            background: white;
            color: #6366f1;
            padding: 1px 4px;
            border-radius: 4px;
            letter-spacing: 0.05em;
        }
    </style>
    <script src="shared.js" defer></script>
</head>

<body>
    <div class="stars"></div>
    <div class="stardust"></div>

    <!-- Shared Navigation -->
    <apsis-nav></apsis-nav>

    <!-- WebGL Scene Container -->
    <div id="canvas-container" class="absolute inset-0 z-0">
        <canvas id="solar-canvas" class="w-full h-full"></canvas>
    </div>

    <!-- Footer -->
    <footer class="fixed bottom-10 left-0 w-full z-20 px-8 flex flex-col items-center">
        <div class="flex space-x-6 mb-4">
            <a href="https://www.linkedin.com/in/kenny-lee-75841319" target="_blank"
                class="text-slate-500 hover:text-white transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                </svg>
            </a>
            <a href="https://www.youtube.com/@kVarfpv" target="_blank"
                class="text-slate-500 hover:text-white transition">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z" />
                </svg>
            </a>
            <a href="https://twitter.com/kenlee308" target="_blank" class="text-slate-500 hover:text-white transition">
                <svg class="w-4 h-4 mt-0.5" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M23.953 4.57c-.885.392-1.83.656-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.957-2.173-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
                </svg>
            </a>
        </div>
        <p class="text-[10px] text-slate-500 uppercase tracking-[0.2em] font-light">"Question Everything. Build the
            Future. Together."</p>
        <p class="text-[8px] text-slate-700 mt-2">&copy; 2026 APSIS INC.</p>
    </footer>

    <!-- Orbit Controls -->
    <button id="orbit-toggle" class="orbit-control-btn">
        <svg id="pause-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <svg id="play-icon" class="hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z">
            </path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span>Pause Orbits</span>
    </button>

    <script type="module">
        import * as THREE from 'three';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        class SolarSystem {
            constructor() {
                this.canvas = document.getElementById('solar-canvas');
                this.container = document.getElementById('canvas-container');
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);

                this.renderer = new THREE.WebGLRenderer({
                    canvas: this.canvas,
                    antialias: true,
                    alpha: true
                });

                this.labelRenderer = new CSS2DRenderer();
                this.labelRenderer.setSize(window.innerWidth, window.innerHeight);
                this.labelRenderer.domElement.style.position = 'absolute';
                this.labelRenderer.domElement.style.top = '0px';
                this.labelRenderer.domElement.style.pointerEvents = 'none'; // Click through to canvas
                this.container.appendChild(this.labelRenderer.domElement);

                this.isPaused = false;
                this.timeMultiplier = 1;
                this.lastTime = 0;
                this.hoveredPlanet = null;
                this.cameraTarget = new THREE.Vector3(0, 0, 0);
                this.isTransitioning = false;
                this.mouse = new THREE.Vector2();
                this.raycaster = new THREE.Raycaster();

                this.init();
            }

            init() {
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

                // Camera Position
                this.camera.position.set(0, 500, 700);
                this.camera.lookAt(0, 0, 0);

                // Lighting
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
                this.scene.add(ambientLight);

                const sunLight = new THREE.PointLight(0xffffff, 5000000, 0, 2);
                sunLight.position.set(0, 0, 0);
                this.scene.add(sunLight);

                // Starfield
                this.createStarfield();

                // Sun
                this.createSun();

                // Planets
                this.planets = [];
                this.createPlanets();

                // Resize handler
                window.addEventListener('resize', () => this.onResize());

                // Interaction
                this.initInteraction();

                // Start Animation Loop
                this.animate(0);

                // Controls
                this.initControls();
            }

            createStarfield() {
                const geometry = new THREE.BufferGeometry();
                const vertices = [];
                for (let i = 0; i < 10000; i++) {
                    vertices.push(
                        THREE.MathUtils.randFloatSpread(4000),
                        THREE.MathUtils.randFloatSpread(4000),
                        THREE.MathUtils.randFloatSpread(4000)
                    );
                }
                geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
                const material = new THREE.PointsMaterial({ color: 0xffffff, size: 1.5, transparent: true, opacity: 0.6 });
                const stars = new THREE.Points(geometry, material);
                this.scene.add(stars);
            }

            createSun() {
                const sunGeometry = new THREE.SphereGeometry(60, 32, 32);
                const sunMaterial = new THREE.MeshBasicMaterial({ color: 0xffd700 });
                this.sun = new THREE.Mesh(sunGeometry, sunMaterial);
                this.scene.add(this.sun);

                // Procedural Glow Texture
                const createGlowTexture = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = 512;
                    canvas.height = 512;
                    const ctx = canvas.getContext('2d');
                    const gradient = ctx.createRadialGradient(256, 256, 0, 256, 256, 256);
                    gradient.addColorStop(0, 'rgba(255, 215, 0, 1)');
                    gradient.addColorStop(0.2, 'rgba(255, 165, 0, 0.8)');
                    gradient.addColorStop(0.5, 'rgba(255, 69, 0, 0.2)');
                    gradient.addColorStop(1, 'rgba(255, 0, 0, 0)');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, 512, 512);
                    return new THREE.CanvasTexture(canvas);
                };

                const glowTexture = createGlowTexture();

                // Primary Glow Sprite
                const spriteMaterial = new THREE.SpriteMaterial({
                    map: glowTexture,
                    color: 0xffcc00,
                    transparent: true,
                    opacity: 0.9,
                    blending: THREE.AdditiveBlending
                });
                const sprite = new THREE.Sprite(spriteMaterial);
                sprite.scale.set(450, 450, 1);
                this.sun.add(sprite);

                // Secondary Outer Glow (Softer)
                const outerSpriteMaterial = new THREE.SpriteMaterial({
                    map: glowTexture,
                    color: 0xff4500,
                    transparent: true,
                    opacity: 0.4,
                    blending: THREE.AdditiveBlending
                });
                const outerSprite = new THREE.Sprite(outerSpriteMaterial);
                outerSprite.scale.set(800, 800, 1);
                this.sun.add(outerSprite);
            }

            createPlanets() {
                const data = [
                    { name: 'AI Maze Navigator', url: 'Javascript Maze Game.html', radius: 150, period: 20, size: 8, color: 0x0ea5e9, target: '_blank' },
                    { name: 'Cosmic Blog', url: 'https://medium.com/@apsis.g9', radius: 250, period: 35, size: 12, color: 0xec4899, target: '_blank' },
                    { name: 'Technical Projects', url: 'projects.html', radius: 360, period: 75, size: 28, color: 0xa855f7, isNew: true },
                    { name: 'The Founder', url: 'aboutme.html', radius: 480, period: 50, size: 22, color: 0x4f46e5 },
                    { name: 'YouTube', url: 'https://www.youtube.com/@kVarfpv', radius: 600, period: 140, size: 25, color: 0x312e81, target: '_blank' },
                    { name: '2025 Archive', url: 'archive_2025/index.html', radius: 750, period: 200, size: 30, color: 0x64748b, target: '_blank' }
                ];

                data.forEach(p => {
                    const geometry = new THREE.SphereGeometry(p.size, 32, 32);
                    const material = new THREE.MeshStandardMaterial({
                        color: p.color,
                        roughness: 0.6,
                        emissive: p.color,
                        emissiveIntensity: 0.15
                    });
                    const mesh = new THREE.Mesh(geometry, material);

                    const group = new THREE.Group();
                    group.add(mesh);
                    this.scene.add(group);

                    // Orbit Path
                    const curve = new THREE.EllipseCurve(0, 0, p.radius, p.radius);
                    const points = curve.getPoints(128);
                    const orbitGeom = new THREE.BufferGeometry().setFromPoints(points);
                    const orbitMat = new THREE.LineBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.15 });
                    const orbit = new THREE.LineLoop(orbitGeom, orbitMat);
                    orbit.rotation.x = Math.PI / 2;
                    this.scene.add(orbit);

                    // Label (CSS2D)
                    const labelDiv = document.createElement('div');
                    labelDiv.className = `planet-label ${p.isNew ? 'highlight' : ''}`;
                    labelDiv.textContent = p.name;
                    labelDiv.style.pointerEvents = 'auto';
                    labelDiv.style.cursor = 'pointer';
                    labelDiv.onclick = (e) => {
                        e.stopPropagation();
                        this.transitionToPlanet(p, mesh);
                    };

                    const label = new CSS2DObject(labelDiv);
                    label.position.set(p.size + 15, p.size + 15, 0);
                    mesh.add(label);

                    this.planets.push({ mesh, group, orbit, config: p, angle: Math.random() * Math.PI * 2, label });
                });
            }

            initInteraction() {
                window.addEventListener('mousemove', (event) => {
                    this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                    this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

                    this.checkHover();
                });

                window.addEventListener('click', (event) => {
                    if (this.isTransitioning) return;
                    this.raycaster.setFromCamera(this.mouse, this.camera);
                    const intersects = this.raycaster.intersectObjects(this.planets.map(p => p.mesh));

                    if (intersects.length > 0) {
                        const clickedPlanet = this.planets.find(p => p.mesh === intersects[0].object);
                        this.transitionToPlanet(clickedPlanet.config, clickedPlanet.mesh);
                    }
                });
            }

            transitionToPlanet(config, mesh) {
                this.isTransitioning = true;
                this.isPaused = true;
                this.cameraTarget = mesh.localToWorld(new THREE.Vector3(0, 0, 0));

                const targetCameraPos = this.cameraTarget.clone().add(new THREE.Vector3(0, 50, 100));

                // Simple animation sequence
                let progress = 0;
                const duration = 1500; // 1.5s
                const startTime = performance.now();

                const animateTransition = (now) => {
                    const elapsed = now - startTime;
                    progress = Math.min(elapsed / duration, 1);

                    // Ease out quadratic
                    const t = 1 - Math.pow(1 - progress, 2);

                    this.camera.position.lerp(targetCameraPos, t * 0.1);
                    this.camera.lookAt(this.cameraTarget);

                    if (progress < 1) {
                        requestAnimationFrame(animateTransition);
                    } else {
                        setTimeout(() => {
                            if (config.target === '_blank') {
                                window.open(config.url, '_blank');
                                this.isPaused = false;
                                this.isTransitioning = false;
                                // Reset camera slowly
                                this.camera.position.set(0, 500, 700);
                                this.camera.lookAt(0, 0, 0);
                            } else {
                                window.location.href = config.url;
                            }
                        }, 500);
                    }
                };

                requestAnimationFrame(animateTransition);
            }

            checkHover() {
                this.raycaster.setFromCamera(this.mouse, this.camera);
                const intersects = this.raycaster.intersectObjects([this.sun, ...this.planets.map(p => p.mesh)]);

                if (intersects.length > 0) {
                    const object = intersects[0].object;
                    const planet = this.planets.find(p => p.mesh === object);

                    if (planet) {
                        if (this.hoveredPlanet !== planet) {
                            if (this.hoveredPlanet) this.hoveredPlanet.mesh.scale.set(1, 1, 1);
                            this.hoveredPlanet = planet;
                            planet.mesh.scale.set(1.2, 1.2, 1.2);
                            document.body.style.cursor = 'pointer';
                        }
                    } else if (object === this.sun) {
                        document.body.style.cursor = 'pointer';
                        if (this.hoveredPlanet) this.hoveredPlanet.mesh.scale.set(1, 1, 1);
                        this.hoveredPlanet = null;
                    }
                } else {
                    if (this.hoveredPlanet) this.hoveredPlanet.mesh.scale.set(1, 1, 1);
                    this.hoveredPlanet = null;
                    document.body.style.cursor = 'default';
                }
            }

            initControls() {
                const toggleBtn = document.getElementById('orbit-toggle');
                const pauseIcon = document.getElementById('pause-icon');
                const playIcon = document.getElementById('play-icon');
                const toggleText = toggleBtn.querySelector('span');

                toggleBtn.addEventListener('click', () => {
                    this.isPaused = !this.isPaused;
                    if (this.isPaused) {
                        pauseIcon.classList.add('hidden');
                        playIcon.classList.remove('hidden');
                        toggleText.textContent = 'Resume Orbits';
                    } else {
                        pauseIcon.classList.remove('hidden');
                        playIcon.classList.add('hidden');
                        toggleText.textContent = 'Pause Orbits';
                    }
                });

                // Speed factor on Sun hold
                window.addEventListener('mousedown', (e) => {
                    if (e.target.closest('#solar-canvas') || e.target.closest('.planet-label')) {
                        this.raycaster.setFromCamera(this.mouse, this.camera);
                        const intersects = this.raycaster.intersectObject(this.sun);
                        if (intersects.length > 0) this.timeMultiplier = 16;
                    }
                });
                window.addEventListener('mouseup', () => this.timeMultiplier = 1);
                window.addEventListener('mouseleave', () => this.timeMultiplier = 1);

                // Touch Events
                this.canvas.addEventListener('touchstart', (e) => {
                    if (e.touches.length === 1) {
                        this.mouse.x = (e.touches[0].clientX / window.innerWidth) * 2 - 1;
                        this.mouse.y = -(e.touches[0].clientY / window.innerHeight) * 2 + 1;
                        this.raycaster.setFromCamera(this.mouse, this.camera);
                        const intersects = this.raycaster.intersectObject(this.sun);
                        if (intersects.length > 0) {
                            e.preventDefault();
                            this.timeMultiplier = 16;
                        }
                    }
                }, { passive: false });

                window.addEventListener('touchend', () => this.timeMultiplier = 1);
            }

            onResize() {
                this.camera.aspect = window.innerWidth / window.innerHeight;
                this.camera.updateProjectionMatrix();
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.labelRenderer.setSize(window.innerWidth, window.innerHeight);
            }

            animate(time) {
                requestAnimationFrame((t) => this.animate(t));

                const delta = (time - this.lastTime) / 1000;
                this.lastTime = time;

                if (!this.isPaused) {
                    this.planets.forEach(p => {
                        p.angle += (delta * this.timeMultiplier) / (p.config.period * 0.2);
                        p.mesh.position.x = Math.cos(p.angle) * p.config.radius;
                        p.mesh.position.z = Math.sin(p.angle) * p.config.radius;
                        p.mesh.rotation.y += delta;
                    });
                }

                this.renderer.render(this.scene, this.camera);
                this.labelRenderer.render(this.scene, this.camera);
            }
        }

        new SolarSystem();
    </script>
</body>

</html>